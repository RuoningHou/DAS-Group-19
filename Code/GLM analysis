#1.load packages
install.packages("tidvverse")
install.packages("moderndive")
install.packages("gapminder")
install.packages("sjPlot")
install.packages("stats")
install.packages("jtools")
install.packages("ggplot")
install.packages("nnet")

library(tidyverse)
library(moderndive)
library(gapminder)
library(sjPlot)
library(stats)
library(jtools)
library(ggplot2)
library(nnet)

#2.load data
data = read.csv("https://github.com/RuoningHou/DAS-Group-19/blob/main/dataset19_cleaned.csv")

#analysis data
evals.data = data %>%
        select(animal_type,intake_type,outcome_type,chip_status,time_at_shelter)
print(evals.data)
ggplot(data = evals.data, aes(x = animal_type, y = time_at_shelter, fill = animal_type)) +
  geom_boxplot() +
  labs(x = "Animal type", y = "Time at shelter")+
  theme(legend.position = "none")

#3. GLM analysis
#3.1 GLM analysis of type
#3.1.1 Animal type
model_glm.animal_type <- glm(time_at_shelter ~ animal_type, data = data, family = poisson())
summary(model_glm.animal_type)
plot(model_glm.animal_type)

#3.1.2  Intake type
model_glm.intake_type <- glm(time_at_shelter ~ intake_type, data = data, family = poisson())
summary(model_glm.intake_type)
plot(model_glm.intake_type)

#3.1.3 Outcome type
model_glm.outcome_type <- glm(time_at_shelter ~ outcome_type, data = data, family = poisson())
summary(model_glm.outcome_type)
plot(model_glm.outcome_type)

#3.1.4 Chip status
model_glm.chip_status <- glm(time_at_shelter ~ chip_status, data = data, family = poisson())
summary(model_glm.chip_status)
plot(model_glm.chip_status)

#3.2 Full Glm analysis
model_full <- glm(time_at_shelter ~ animal_type + intake_type + outcome_type + chip_status,
                  data = data,
                  family = poisson())
summary(model_full)
plot(model_full)

#3.3 AIC analysis
AIC(model_glm.animal_type, model_glm.intake_type, model_glm.outcome_type, model_glm.chip_status, model_full)
