---
title: "GLM Analysis of Animal Shelter Data"
author: "Generated by ChatGPT"
format: html
---

# Load Packages
```{r}
install.packages("tidyverse")
install.packages("moderndive")
install.packages("gapminder")
install.packages("sjPlot")
install.packages("stats")
install.packages("jtools")
install.packages("ggplot2")
install.packages("nnet")

library(tidyverse)
library(moderndive)
library(gapminder)
library(sjPlot)
library(stats)
library(jtools)
library(ggplot2)
library(nnet)
```

# Load Data
```{r}
data <- read.csv("C:/Users/13849/Group2/dataset19_cleaned.csv")

# Select relevant columns
evals.data <- data %>%
  select(animal_type, intake_type, outcome_type, chip_status, time_at_shelter)

# Display summary of the dataset
summary(evals.data)
```

**Analysis:**
The dataset contains key variables related to animals in a shelter, including the type of animal, the method of intake, the outcome type, and whether the animal is chipped. The variable `time_at_shelter` represents how long each animal stays at the shelter, which is our primary dependent variable.

# Data Visualization
## Boxplot of Time at Shelter by Animal Type
```{r}
ggplot(data = evals.data, aes(x = animal_type, y = time_at_shelter, fill = animal_type)) +
  geom_boxplot() +
  labs(x = "Animal Type", y = "Time at Shelter") +
  theme(legend.position = "none")
```
**Analysis:**
The boxplot shows the distribution of shelter time for different animal types. If certain animal types have a significantly longer median stay, it could suggest adoption preferences or challenges specific to that type. Outliers in the data may indicate special cases of extended stays.

# GLM Analysis
## GLM for Animal Type
```{r}
model_glm.animal_type <- glm(time_at_shelter ~ animal_type, data = data, family = poisson())
summary(model_glm.animal_type)
plot(model_glm.animal_type)
```
**Analysis:**
This model examines whether different animal types have a statistically significant effect on shelter time. The `summary()` function provides p-values and coefficients, where a significant coefficient indicates that an animal type influences how long it stays at the shelter.

## GLM for Intake Type
```{r}
model_glm.intake_type <- glm(time_at_shelter ~ intake_type, data = data, family = poisson())
summary(model_glm.intake_type)
plot(model_glm.intake_type)
```
**Analysis:**
This model investigates the impact of intake type (e.g., stray, owner surrender, transfer) on the duration an animal stays in the shelter. Significant intake types may suggest that certain categories of animals are harder to adopt or require more care.

## GLM for Outcome Type
```{r}
model_glm.outcome_type <- glm(time_at_shelter ~ outcome_type, data = data, family = poisson())
summary(model_glm.outcome_type)
plot(model_glm.outcome_type)
```
**Analysis:**
Different outcome types (e.g., adoption, return to owner, euthanasia) could have varying effects on shelter duration. A significant coefficient would indicate that a particular outcome type is associated with longer or shorter stays.

## GLM for Chip Status
```{r}
model_glm.chip_status <- glm(time_at_shelter ~ chip_status, data = data, family = poisson())
summary(model_glm.chip_status)
plot(model_glm.chip_status)
```
**Analysis:**
Chipped animals might have a shorter shelter stay if their owners are more likely to claim them. If the coefficient is negative and significant, it suggests that chipped animals leave the shelter faster.

# Full GLM Analysis
```{r}
model_full <- glm(time_at_shelter ~ animal_type + intake_type + outcome_type + chip_status,
                  data = data, family = poisson())
summary(model_full)
plot(model_full)
```
**Analysis:**
This full model incorporates all predictor variables. Comparing this model to individual models helps assess whether a combined model provides better predictive power. If variables lose significance in this model, it may indicate collinearity or interactions between predictors.

# Model Comparison using AIC
```{r}
AIC(model_glm.animal_type, model_glm.intake_type, model_glm.outcome_type, model_glm.chip_status, model_full)
```
**Analysis:**
A lower AIC value indicates a better-fitting model. Comparing AIC values across models helps determine which set of predictors is most useful for predicting shelter stay duration.

# Conclusion
This analysis explores the effects of animal type, intake type, outcome type, and chip status on the time an animal stays at the shelter. Key findings include:
- Certain animal types may have longer shelter stays.
- Intake and outcome types significantly affect duration.
- Microchipping might be associated with faster retrieval.

Future research could consider interaction effects or additional variables (e.g., breed, health status) to refine predictions.

